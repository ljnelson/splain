<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>README.md</title>

</head>

<body>

<!-- -*- markdown -*- -->

<h1><code>splain</code></h1>

<h2>Intelligent Error Messages for Java</h2>

<h3>February 18, 2013</h3>

<h3><a href="http://about.me/lairdnelson">Laird Nelson</a></h3>

<p><code>splain</code> is a small project that matches <a href="http://ljnelson.github.com/objexj"><code>objexj</code></a> <a href="http://ljnelson.github.com/objexj/apidocs/com/edugility/objexj/Pattern.html"><code>Pattern</code></a>s
against <code>List</code>s of <code>Object</code>s to produce rich error messages.</p>

<p><code>splain</code> has two fundamental concepts.</p>

<ol>
<li><p><strong>Message selector.</strong> A message selector is a key into a
particular <a href="http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html"><code>ResourceBundle</code></a>.</p></li>
<li><p><strong>Message catalog.</strong> A message catalog is an ordered list of
<a href="http://ljnelson.github.com/objexj"><code>objexj</code></a> <a href="http://ljnelson.github.com/objexj/apidocs/com/edugility/objexj/Pattern.html"><code>Pattern</code></a>s and message selectors that certain
of those <a href="http://ljnelson.github.com/objexj/apidocs/com/edugility/objexj/Pattern.html"><code>Pattern</code></a>s, when matched, will cause to be selected.</p></li>
</ol>

<p><code>splain</code> unites these two concepts together so that when you hand it a
<code>List</code> of <code>Object</code>s and a message catalog, it will return an
appropriate message selector.  From the message selector you can
<a href="http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html#getObject(java.lang.String)">get a value out of a <code>ResourceBundle</code></a>.</p>

<h3>Sample Message Catalog</h3>

<pre><code># (Line comments like this one start with the hash (#) character.
# objexj patterns are separated from corresponding message selectors
# by a double-dash.
java.lang.String(toString() == "a")/java.lang.String(toString() == "b")$
^java.lang.String(toString() == "c")
--
com.foobar.Bizbaw/sampleKey
</code></pre>

<p>In the sample message catalog above, <code>splain</code> will attempt to match
the first pattern against a user-supplied <code>List</code> of <code>Object</code>s (the
pattern says that a match will occur if the <code>List</code> ends with a
sequence of two strings, "<code>a</code>" and "<code>b</code>").  If that fails, then
<code>splain</code> will attempt to match the next pattern against the list.  If
either pattern succeeds, then the corresponding message selector
(<code>com.foobar.Bizbaw/sampleKey</code>) is used to identify a
<a href="http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html"><code>ResourceBundle</code></a> and a key inside it.</p>

<p>This means that if we use <code>splain</code> to find a message selector for
<code>Arrays.asList("x", "y", "z")</code> it will fail, but if we supply it with
either <code>Arrays.asList("c")</code> or <code>Arrays.asList("a", "b", "c")</code> it will
return a message selector that picks out the <code>sampleKey</code> key in the
<a href="http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html"><code>ResourceBundle</code></a> named by the bundle name of <code>com.foobar.Bizbaw</code>.</p>

<p><code>splain</code> then goes ahead and dereferences that key by calling the
<a href="http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html#getObject(java.lang.String)"><code>ResourceBundle#getObject(String)</code></a> method for us.  The resulting
<code>Object</code>, if it is a <code>String</code>, is treated as an <a href="http://mvel.codehaus.org/">MVEL</a>
<a href="http://mvel.codehaus.org/MVEL+2.0+Templating+Guide">template</a>, and is interpolated using variables set in our <code>objexj</code>
<a href="http://ljnelson.github.com/objexj/apidocs/com/edugility/objexj/Pattern.html">pattern</a>s!</p>

</body>
</html>
